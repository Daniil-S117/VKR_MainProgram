# Выпускная квалификационная работа на тему: «Разработка системы мониторинга для определения показаний аналоговых манометров на основе технического зрения и машинного обучения»

# Выполнил: обучающийся гр. ИИСм-1-23 Сушков Даниил Сергеевич Научный руководитель: доцент, к.т.н. Надеждина М. Е. 

# Разработка программного обеспечения системы мониторинга для определения показаний аналоговых манометров с использованием технологий компьютерного зрения и методов машинного обучения. 

# Использованные библиотеки python: 
OpenCV-Python – библиотека компьютерного зрения для обработки изображений;
Python Imaging Library – библиотека языка Python для работы с растровой графикой. 
NumPy – библиотека предназначенная для работы с многомерными массивами (включая матрицы) и выполнения математических операций над ними;
Matplotlib – библиотека для визуализации данных двумерной и трёхмерной графикой
Ultralytics YOLOv8 – это мощная библиотека для компьютерного зрения для задач обнаружения объектов, сегментации, классификации и отслеживания;
DINOv2 – модель компьютерного зрения, обученная самоконтролируемом методом;
Mean Shift – это метод кластеризации, который находит кластеры путём перемещения центроидов в направлении максимальной плотности данных;
MMOCR – инструмент для обнаружения и распознавания текста и извлечение информации;
Модель DBNet – используется для обнаружения текста произвольной формы;
SAR «Show, Attend and Read» – это модель последовательного декодирования;

В данной работе предложен метод, позволяющий определять показания аналоговых манометров с использованием технологий компьютерного зрения, включая модели сегментации изображений YOLOv8, определение ключевых точек DINOv2 и оптическое распознавание символов (OCR). Основой данного метода является то, что все аналоговые манометры имеют циферблат, стрелку и шкалу с отметками. Главной целью этого подхода является обеспечение стабильной точности считывания показаний для всех приборов, которые могут быть использованы на предприятии, вне зависимости от их внешнего оформления, шкал и единиц измерения.
Вначале модель обнаружения и сегментации YOLOv8 идентифицирует манометр на изображении, после чего осуществляет сегментацию циферблата и стрелки [16]. Модель была предварительно обучена на наборе данных COCO и дополнительно адаптирована на небольшом наборе, включающем около 2000 размеченных изображений [17]. Для определения траектории сегментированной стрелки на изображении используется метод ортогональных расстояний (ODR), который позволяет минимизировать расстояние каждой точки до прямой [18].
 При обнаружение каждого объекта применяется простая модель определения ключевых точки для выявления крупных отметки на шкале. 
Для создания модели технического зрения, обучаемой на ограниченном количестве примеров, применяется предварительно обученный трансформатор зрения DINOv2 [19]. Для прогнозирования тепловых карт на основе извлеченных признаков внедрена структура декодера, представляющая собой двухступенчатую сеть слоев CNN 1x1, за которой следует билинейный этап восходящей дискретизации. После восходящей дискретизации осуществляется сигмоидальная активация. Для создания тепловых карт в процессе обучения применяется гауссово распределение, центрированное в каждой ключевой точке [20]. Эти тепловые карты нормализуются таким образом, чтобы их значения находились в диапазоне от 0 до 1. 
В процессе обучения модели параметры магистрали фиксируются, в то время как остальные параметры оптимизируются с использованием функции двоичных потерь на основе кросса-энтропии, а также методов стохастического градиентного спуска и оптимизатора Адама [21]. 
Для извлечения ключевых точек из предсказанных тепловых карт применяется алгоритм Mean-Shift, который кластеризует индексы тепловых карт с значениями выше 0.5 [22]. Учитывая возможность перспективного искажения, а также тот факт, что многие приборы не имеют идеально круглой шкалы или обладают шкалой, радиус которой превышает радиус манометра, алгоритм накладывает эллипс на выявленные ключевые точки. 
Затем запускается процесс оптического распознавания символов (OCR), который позволяет идентифицировать единицы измерения и отметки шкалы на лицевой панели прибора, связывая их с эллипсом [23]. Модель состоит из двух последовательных этапов и основана на глубокой нейронной сети. Первая сеть отвечает за поиск текста, а вторая за его распознавания. Для поиска текста применяется модель DB_r50, представляющая собой сегментирующую модель, использующую архитектуру ResNet-18 [24]. Распознавание же текста осуществляется с помощью модели SAR, которая комбинирует визуальные и языковые признаки для прогнозирования текста внутри обнаруженных прямоугольных областей [25]. Для работы обеих моделей используется библиотека MMOCR.
Линейная регрессия, основанная на методе наименьших квадратов, подвержена влиянию аномальных значений. Эти аномалии могут возникать из-за ошибок в распознавании текста (OCR) или из-за наличия посторонних чисел на приборе, таких как серийный номер. Для устранения выбросов используется алгоритм RANSAC [26]. Линейная модель, применяющая алгоритм RANSAC, должна быть согласована с обнаруженными метками, поскольку некоторые из них могут быть неправильно интерпретированы [27]. 
Для обеспечения определения показаний приборов с несколькими шкалами, модель настроена на различение отметок внутренней и внешней шкал [28]. Это достигается путем проверки их расположения относительно эллипса: внутри или снаружи. На основе данного различения система последовательно подстраивает две отдельные линейные модели, причем каждая из них предназначена для одной из шкал. Далее осуществляется расчет показаний для каждой шкалы, основываясь на соответствующих моделях.
В итоге система находит точку пересечения между стрелкой и предполагаемым эллипсом и предсказывает показания аналогового манометра путем интерполяции с помощью линейной модели. Общий обзор алгоритма показан на рисунке 3. 

# ЗАКЛЮЧЕНИЕ

В выпускной квалификационной работы проведён теоретический обзор принципов работы существующих систем мониторинга оборудования, технического зрения и машинного обучения. Рассмотрено устройство аналоговых манометров и требований к разрабатываемой системе.  Спроектирована архитектура системы, интерфейса и базы данных. Предложен алгоритм определения показаний аналоговых манометров с применением методов технического зрения и машинного обучения. Для реализации системы выбраны подходящие инструментальные средства. Разработано программное обеспечение «система мониторинга для определения показаний аналоговых манометров на основе технического зрения и машинного обучения» для ПК, работающих на операционной системе Windows. В соответствии с социальной ответственностью сформирована техника безопасности при работе с приложением, которая поможет пользователям при выполнении ими служебных обязанностей. В рамках финансового менеджмента был проведён технико-экономический расчёт эффективности затрат на разработку и внедрение системы.
Разработанное приложение соответствует всем установленным требованиям и обладает рядом преимуществ, включая низкую стоимость по сравнению с аналогичными решениями, компактность и удобство в использовании.
Созданная система обладает высоким потенциалом для широкого применения в различных отраслях. Эффективное внедрение этих технологий может существенно увеличить как точность, так и скорость решения задач на предприятиях производственного, нефтегазового, фармацевтического, химического сектора. В условиях постоянного технологического прогресса использование автоматизированных систем станет важным шагом вперед в будущем.
 
